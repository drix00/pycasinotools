#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
.. py:currentmodule:: tests.file_format.casino3.exported.test_energy
.. moduleauthor:: Hendrix Demers <Demers.Hendrix@hydro.qc.ca>

Tests for the :py:mod:`casinotools.file_format.casino3.exported.energy` module.
"""


# Copyright 2020 Hendrix Demers
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# Standard library modules.
import os.path

# Third party modules.
import pytest
from pkg_resources import resource_filename
import numpy as np

# Project modules.
from casinotools.file_format.casino3.exported.energy import EnergyCartesian, EnergyCylindrical, EnergySpherical


# Local modules.

# Globals and constants variables.


@pytest.fixture()
def file_path_energy_cartesian_dat():
    name = "../../../../test_data/casino3.x/v3.3/v3.3.0.4/energy_deposition_cartesian_v3.3.0.4_Energy_by_position.dat"
    file_path = resource_filename(__name__, name)
    return file_path


@pytest.fixture()
def file_path_energy_cylindrical_dat():
    name = "../../../../test_data/casino3.x/v3.3/v3.3.0.4/energy_deposition_cylindrical_v3.3.0.4_Energy_by_position.dat"
    file_path = resource_filename(__name__, name)
    return file_path


@pytest.fixture()
def file_path_energy_spherical_dat():
    name = "../../../../test_data/casino3.x/v3.3/v3.3.0.4/energy_deposition_spherical_v3.3.0.4_Energy_by_position.dat"
    file_path = resource_filename(__name__, name)
    return file_path


@pytest.fixture()
def energy_cartesian_data_empty():
    energy_cartesian = EnergyCartesian()
    return energy_cartesian


@pytest.fixture()
def energy_cartesian_data():
    energy_cartesian = EnergyCartesian()
    energy_cartesian.maximum_density_keV = 29050.4
    energy_cartesian.x_size_nm = 10.0
    energy_cartesian.x_number_divisions = 50
    energy_cartesian.y_size_nm = 10.0
    energy_cartesian.y_number_divisions = 50
    energy_cartesian.z_size_nm = 10.0
    energy_cartesian.z_number_divisions = 50
    energy_cartesian.range_x_nm = [-250.0, 250.0]
    energy_cartesian.range_y_nm = [-250.0, 250.0]
    energy_cartesian.range_z_nm = [0.0, 500.0]

    # self.xs_nm = [-250.         -239.79591837 -229.59183673 -219.3877551  -209.18367347, -198.97959184 -188.7755102  -178.57142857 -168.36734694 -158.16326531, -147.95918367 -137.75510204 -127.55102041 -117.34693878 -107.14285714,  -96.93877551  -86.73469388  -76.53061224  -66.32653061  -56.12244898,  -45.91836735  -35.71428571  -25.51020408  -15.30612245   -5.10204082,    5.10204082   15.30612245   25.51020408   35.71428571   45.91836735,   56.12244898   66.32653061   76.53061224   86.73469388   96.93877551,  107.14285714  117.34693878  127.55102041  137.75510204  147.95918367,  158.16326531  168.36734694  178.57142857  188.7755102   198.97959184,  209.18367347  219.3877551   229.59183673  239.79591837  250.        ]
    # self.ys_nm = [-250.         -239.79591837 -229.59183673 -219.3877551  -209.18367347, -198.97959184 -188.7755102  -178.57142857 -168.36734694 -158.16326531, -147.95918367 -137.75510204 -127.55102041 -117.34693878 -107.14285714,  -96.93877551  -86.73469388  -76.53061224  -66.32653061  -56.12244898,  -45.91836735  -35.71428571  -25.51020408  -15.30612245   -5.10204082,    5.10204082   15.30612245   25.51020408   35.71428571   45.91836735,   56.12244898   66.32653061   76.53061224   86.73469388   96.93877551,  107.14285714  117.34693878  127.55102041  137.75510204  147.95918367,  158.16326531  168.36734694  178.57142857  188.7755102   198.97959184,  209.18367347  219.3877551   229.59183673  239.79591837  250.        ]
    # self.zs_nm = [  0.          10.20408163  20.40816327  30.6122449   40.81632653,  51.02040816  61.2244898   71.42857143  81.63265306  91.83673469, 102.04081633 112.24489796 122.44897959 132.65306122 142.85714286, 153.06122449 163.26530612 173.46938776 183.67346939 193.87755102, 204.08163265 214.28571429 224.48979592 234.69387755 244.89795918, 255.10204082 265.30612245 275.51020408 285.71428571 295.91836735, 306.12244898 316.32653061 326.53061224 336.73469388 346.93877551, 357.14285714 367.34693878 377.55102041 387.75510204 397.95918367, 408.16326531 418.36734694 428.57142857 438.7755102  448.97959184, 459.18367347 469.3877551  479.59183673 489.79591837 500.        ]

    # energy_cartesian.energies_keV = [1559.79, 10966.5, 29838.1, 57438.2, 93917.4, 138602.0, 190006.0, 247896.0,
    #                                  310546.0, 378282.0, 446494.0, 514452.0, 577613.0, 633285.0, 675042.0, 699366.0,
    #                                  701430.0, 678552.0, 522830.0, 442499.0, 392844.0, 348752.0, 310639.0, 272963.0,
    #                                  238278.0, 175451.0, 146569.0, 121735.0, 100570.0, 82505.4, 66767.5, 54159.5,
    #                                  43297.3, 34490.0, 27846.7, 22097.0, 17687.5, 14237.3, 11486.8, 9268.19, 7732.89,
    #                                  6549.81, 5758.73, 5051.5, 4510.56, 4085.29, 3815.15, 3530.35, 3350.9, 3151.28]

    return energy_cartesian



@pytest.fixture()
def energy_cylindrical_data_empty():
    energy_cylindrical = EnergyCylindrical()
    return energy_cylindrical


@pytest.fixture()
def energy_cylindrical_data():
    energy_cylindrical = EnergyCylindrical()
    energy_cylindrical.maximum_density_keV = 109774.0
    energy_cylindrical.radius_size_nm = 10.0
    energy_cylindrical.radius_number_divisions = 50
    energy_cylindrical.z_size_nm = 10.0
    energy_cylindrical.z_number_divisions = 50
    energy_cylindrical.center_nm = [0.0, 0.0]
    energy_cylindrical.range_z_nm = [0, 500]

    energy_cylindrical.radiuses_nm = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0,
                                      130.0, 140.0, 150.0, 160.0, 170.0, 180.0, 190.0, 200.0, 210.0, 220.0, 230.0,
                                      240.0,
                                      250.0, 260.0, 270.0, 280.0, 290.0, 300.0, 310.0, 320.0, 330.0, 340.0, 350.0,
                                      360.0,
                                      370.0, 380.0, 390.0, 400.0, 410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0,
                                      480.0, 490.0]
    energy_cylindrical.zs_nm = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0,
                                140.0, 150.0, 160.0, 170.0, 180.0, 190.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0,
                                260.0, 270.0, 280.0, 290.0, 300.0, 310.0, 320.0, 330.0, 340.0, 350.0, 360.0, 370.0,
                                380.0, 390.0, 400.0, 410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0, 480.0, 490.0]
    energy_cylindrical.energies_keV = [
        [32161.7, 439.311, 647.59, 849.824, 1029.73, 1145.96, 1280.6, 1371.68, 1428.7, 1479.16, 1508.0, 1515.87,
         1498.58, 1502.03, 1465.42, 1410.03, 1346.99, 1304.68, 1221.45, 1166.57, 1084.67, 1005.61, 944.333, 867.567,
         802.337, 737.203, 679.111, 630.59, 576.59, 529.718, 482.29, 449.967, 414.698, 373.298, 336.314, 310.489,
         290.314, 264.331, 243.135, 224.505, 203.862, 188.57, 179.019, 163.335, 152.935, 143.88, 134.016, 125.771,
         115.801, 107.862],
        [34455.8, 690.734, 867.97, 1094.57, 1294.14, 1430.87, 1587.64, 1674.62, 1722.75, 1769.61, 1777.51, 1793.06,
         1781.71, 1745.24, 1703.19, 1620.36, 1544.36, 1486.51, 1379.99, 1296.18, 1230.15, 1137.2, 1034.61, 979.748,
         894.403, 832.435, 761.775, 696.086, 631.353, 575.047, 536.302, 493.992, 455.286, 425.532, 386.662, 366.52,
         325.948, 305.504, 285.235, 263.02, 252.221, 230.534, 210.543, 195.483, 185.67, 175.064, 170.816, 157.208,
         149.367, 136.22],
        [37996.4, 1183.82, 1208.98, 1441.91, 1647.65, 1812.02, 1970.69, 2037.94, 2089.91, 2157.29, 2131.23, 2130.34,
         2090.66, 2016.93, 1921.51, 1835.86, 1748.35, 1642.88, 1530.83, 1433.52, 1349.17, 1232.46, 1139.59, 1047.85,
         971.617, 892.242, 814.634, 741.176, 683.262, 625.758, 566.5, 530.271, 483.151, 434.117, 402.026, 369.716,
         349.453, 325.162, 310.201, 290.052, 269.032, 250.596, 228.451, 215.418, 212.558, 197.699, 186.079, 178.736,
         168.918, 154.265],
        [37401.3, 1926.51, 1569.68, 1740.16, 1930.08, 2091.58, 2188.22, 2274.49, 2310.55, 2332.23, 2303.74, 2268.68,
         2181.54, 2073.08, 1974.48, 1876.23, 1776.24, 1649.09, 1536.6, 1424.18, 1317.59, 1206.64, 1093.34, 1007.98,
         925.024, 839.568, 769.03, 694.447, 624.397, 562.158, 517.235, 479.27, 431.958, 391.458, 370.183, 340.479,
         310.2, 301.534, 274.954, 265.133, 246.965, 233.357, 224.337, 207.497, 199.497, 188.939, 179.612, 162.448,
         159.486, 155.944],
        [36442.0, 3050.25, 2104.07, 2154.34, 2283.39, 2382.22, 2465.9, 2537.49, 2542.15, 2506.71, 2422.21, 2365.43,
         2246.19, 2131.14, 2019.95, 1904.41, 1737.9, 1631.16, 1505.25, 1388.05, 1256.72, 1151.63, 1040.19, 949.841,
         850.347, 776.911, 706.618, 639.271, 580.246, 523.618, 484.843, 439.851, 410.346, 377.104, 345.017, 318.282,
         300.073, 273.862, 255.163, 252.174, 229.73, 216.975, 207.188, 201.657, 188.623, 179.565, 169.835, 164.807,
         154.277, 148.595],
        [35198.8, 4644.43, 2856.96, 2691.94, 2707.26, 2773.01, 2793.71, 2782.57, 2729.49, 2654.78, 2560.27, 2430.1,
         2265.57, 2141.54, 2005.39, 1866.29, 1730.07, 1581.59, 1439.14, 1298.85, 1175.5, 1078.72, 981.771, 879.45,
         789.491, 712.672, 643.98, 589.765, 534.629, 480.046, 443.46, 398.211, 379.598, 341.087, 320.707, 299.162,
         272.88, 261.583, 242.001, 226.191, 221.08, 206.532, 194.682, 183.589, 177.644, 165.672, 159.554, 154.03,
         147.891, 144.182],
        [38131.6, 8629.85, 4817.4, 4019.97, 3748.4, 3581.59, 3437.88, 3271.1, 3123.86, 2951.82, 2791.98, 2551.18,
         2385.49, 2184.21, 2038.31, 1860.02, 1695.69, 1512.49, 1351.51, 1185.74, 1062.06, 947.563, 850.269, 756.869,
         665.715, 587.356, 540.257, 477.233, 412.637, 364.557, 337.224, 315.678, 266.498, 239.086, 241.269, 220.669,
         206.628, 184.722, 184.027, 170.821, 163.512, 159.22, 149.986, 147.698, 140.278, 129.665, 130.833, 131.159,
         118.692, 114.622],
        [109774.0, 35796.4, 20151.0, 16546.4, 15108.5, 14370.6, 13776.2, 13183.3, 12545.8, 11856.7, 11150.6, 10445.1,
         9623.33, 8926.54, 8293.67, 7532.23, 6742.45, 5997.5, 5382.6, 4687.45, 4163.54, 3669.77, 3237.65, 2835.73,
         2418.7, 2111.82, 1842.37, 1563.62, 1343.68, 1175.21, 1008.97, 865.317, 736.431, 653.09, 577.897, 514.224,
         470.793, 408.209, 396.887, 388.454, 327.68, 289.969, 291.338, 299.345, 276.218, 295.451, 285.221, 282.96,
         253.708, 223.998],
        [87334.0, 48538.3, 28351.3, 22536.4, 20005.9, 18768.1, 17969.7, 17024.7, 16262.3, 15356.9, 14431.7, 13623.0,
         12644.1, 11790.4, 10840.4, 9961.02, 9091.83, 8141.82, 7212.98, 6332.29, 5620.51, 4995.4, 4306.78, 3774.51,
         3230.85, 2766.89, 2314.0, 1982.5, 1667.98, 1412.49, 1157.82, 973.927, 815.361, 724.413, 574.621, 492.245,
         470.22, 373.596, 331.728, 315.724, 297.695, 262.093, 220.904, 200.543, 214.762, 217.038, 217.738, 202.159,
         176.012, 169.695],
        [60377.7, 54653.3, 35678.0, 27978.8, 24619.7, 22757.4, 21343.5, 20380.7, 19322.6, 18342.7, 17372.9, 16346.7,
         15199.8, 14111.8, 12970.6, 11990.7, 10846.5, 9654.07, 8733.27, 7717.16, 6873.32, 6064.8, 5330.07, 4608.08,
         3892.95, 3369.98, 2805.02, 2331.65, 1953.31, 1715.83, 1375.43, 1154.87, 932.617, 784.32, 627.062, 511.283,
         451.792, 376.128, 319.039, 287.74, 264.039, 245.483, 235.209, 196.52, 178.523, 190.052, 175.313, 187.437,
         169.991, 165.67],
        [38555.0, 51599.0, 39874.5, 32340.7, 28411.2, 26135.6, 24532.2, 23200.8, 22100.0, 20919.4, 19677.4, 18626.9,
         17444.1, 16122.7, 14823.2, 13594.4, 12293.0, 11176.2, 9949.95, 8969.01, 7939.06, 7034.38, 6112.51, 5308.37,
         4526.93, 3814.79, 3274.82, 2725.99, 2252.31, 1914.0, 1522.34, 1272.95, 1055.01, 823.277, 674.185, 542.753,
         452.709, 360.058, 323.032, 301.114, 241.303, 223.097, 226.115, 179.309, 169.226, 164.297, 148.352, 153.375,
         159.148, 150.0],
        [24257.9, 43124.1, 39943.9, 34563.4, 31016.4, 28630.7, 26998.7, 25635.8, 24230.4, 23007.0, 21561.1, 20365.6,
         19216.9, 17690.9, 16279.4, 14853.9, 13703.3, 12402.0, 11147.9, 9904.48, 8805.7, 7821.1, 6745.15, 5903.6,
         5082.67, 4259.81, 3637.26, 3050.62, 2540.61, 2122.95, 1637.61, 1342.11, 1111.26, 909.44, 709.045, 586.845,
         478.451, 393.634, 305.495, 279.622, 253.665, 199.56, 187.563, 159.775, 165.998, 144.664, 126.549, 138.752,
         128.587, 117.65],
        [15750.1, 33868.9, 36537.4, 34458.5, 32148.7, 30058.8, 28466.0, 27166.2, 25842.6, 24442.8, 23072.7, 21958.6,
         20591.5, 19065.0, 17477.5, 16011.2, 14664.1, 13492.3, 12049.7, 10774.1, 9478.37, 8411.26, 7331.46, 6324.25,
         5413.54, 4554.7, 3856.83, 3288.49, 2670.71, 2222.92, 1854.91, 1457.87, 1207.17, 953.874, 788.762, 604.158,
         498.737, 380.876, 330.286, 279.347, 260.563, 194.746, 159.506, 156.601, 133.791, 120.369, 140.238, 120.439,
         126.531, 110.615],
        [10789.7, 26027.6, 31743.8, 32432.9, 31481.4, 30315.3, 29115.0, 28041.4, 26842.9, 25511.8, 24268.2, 22863.4,
         21369.9, 19903.3, 18429.4, 16980.5, 15553.4, 14099.7, 12647.5, 11396.1, 10191.0, 8891.39, 7719.55, 6645.91,
         5633.61, 4803.66, 4075.5, 3459.15, 2791.19, 2289.7, 1919.21, 1491.82, 1188.82, 946.953, 791.225, 610.889,
         502.093, 392.61, 350.296, 287.777, 238.333, 171.427, 147.191, 142.046, 133.742, 121.858, 102.975, 96.2352,
         106.248, 106.335],
        [7756.58, 20223.1, 26960.5, 29423.9, 30137.0, 29741.4, 28918.1, 27945.4, 27191.8, 26018.9, 24683.0, 23270.3,
         21874.6, 20528.2, 19017.3, 17482.0, 15966.6, 14592.6, 13086.2, 11809.7, 10501.9, 9108.41, 8034.05, 6898.35,
         5725.37, 4934.58, 4205.06, 3509.81, 2909.96, 2368.18, 1918.0, 1544.31, 1216.6, 994.299, 798.076, 607.479,
         480.557, 380.557, 332.869, 260.101, 210.361, 167.569, 125.428, 123.439, 111.027, 108.801, 87.9213, 87.3646,
         84.7208, 97.6587],
        [5829.04, 15914.1, 22642.8, 26303.5, 28033.9, 28274.0, 28106.9, 27608.0, 26881.0, 25831.1, 24572.8, 23414.9,
         21917.2, 20655.8, 19141.7, 17716.5, 16254.6, 14778.6, 13310.8, 12000.0, 10557.8, 9336.72, 8104.98, 6912.57,
         5998.23, 5116.2, 4323.9, 3633.1, 2995.47, 2369.79, 1929.05, 1513.27, 1235.17, 980.338, 753.276, 573.882,
         481.76, 356.23, 292.501, 240.654, 183.924, 144.096, 127.372, 119.13, 92.4962, 94.447, 90.0924, 70.3589,
         79.5336, 75.1925],
        [4598.99, 12829.6, 18937.7, 23021.7, 25296.8, 26343.9, 26637.6, 26435.6, 26007.7, 25189.8, 24161.3, 23280.7,
         21939.6, 20649.2, 19278.9, 17748.6, 16407.6, 14825.1, 13397.6, 12168.7, 10720.6, 9496.99, 8222.78, 7030.49,
         6081.21, 5167.34, 4399.66, 3665.82, 2932.06, 2383.23, 1904.73, 1558.12, 1229.93, 1006.82, 781.014, 558.215,
         416.756, 361.798, 289.17, 246.637, 170.8, 147.389, 123.817, 92.1799, 84.631, 79.3915, 73.7625, 62.9109,
         66.8679, 64.2128],
        [3716.1, 10526.2, 16121.2, 20272.9, 22929.1, 24339.3, 25084.9, 25165.3, 25089.3, 24448.1, 23562.4, 22619.3,
         21551.5, 20280.5, 18985.7, 17554.9, 16205.0, 14728.1, 13297.6, 12032.6, 10677.1, 9332.16, 8110.36, 6995.55,
         6035.46, 5137.6, 4361.85, 3507.98, 2894.91, 2373.75, 1855.71, 1541.23, 1240.78, 994.899, 799.37, 597.133,
         416.315, 320.798, 263.522, 199.072, 174.804, 115.687, 96.748, 87.456, 82.6423, 65.2215, 56.2497, 52.2638,
         47.8115, 57.5139],
        [3057.17, 8933.76, 13797.1, 17596.5, 20591.5, 22341.5, 23264.3, 23715.7, 23675.8, 23274.5, 22651.7, 21940.0,
         20759.7, 19659.0, 18451.0, 17106.7, 15783.1, 14362.7, 13147.8, 11739.0, 10365.7, 9055.19, 7928.22, 6910.96,
         5963.88, 4912.2, 4211.3, 3460.89, 2857.93, 2351.0, 1834.99, 1462.92, 1167.93, 910.025, 734.539, 561.419,
         391.961, 298.196, 255.687, 180.124, 156.638, 124.523, 81.9257, 73.8685, 76.0052, 56.9816, 49.7374, 47.3329,
         63.7338, 52.9113],
        [2571.77, 7591.38, 11955.5, 15521.9, 18228.5, 20206.3, 21385.4, 22062.1, 22204.7, 22105.7, 21529.8, 20853.0,
         20093.6, 18869.3, 17835.4, 16437.3, 15097.3, 13810.6, 12634.5, 11462.9, 10145.1, 8900.03, 7673.69, 6620.12,
         5637.73, 4802.71, 4048.24, 3434.76, 2790.15, 2196.91, 1780.68, 1364.08, 1089.16, 907.57, 691.441, 539.233,
         400.208, 285.838, 236.411, 170.034, 125.998, 100.864, 70.5, 71.0079, 52.2077, 51.0022, 51.9072, 47.5768,
         45.9393, 38.533],
        [2191.36, 6440.49, 10293.8, 13656.8, 16194.3, 18345.3, 19538.9, 20286.7, 20697.8, 20851.5, 20466.3, 19737.0,
         18990.5, 18115.7, 16861.5, 15698.6, 14544.6, 13271.3, 12084.7, 10863.9, 9645.29, 8389.75, 7273.93, 6340.91,
         5410.71, 4624.97, 3792.45, 3140.37, 2657.1, 2097.83, 1693.91, 1342.27, 1022.89, 850.261, 636.842, 509.617,
         364.057, 267.711, 204.475, 154.991, 116.467, 90.3352, 63.0424, 42.086, 41.7478, 46.194, 53.8302, 51.1301,
         40.5892, 30.4646],
        [1949.88, 5650.17, 9010.29, 11937.1, 14378.0, 16444.3, 17751.4, 18578.4, 19068.1, 19316.2, 19087.5, 18482.9,
         17756.9, 17027.2, 15862.4, 14818.7, 13683.0, 12432.1, 11334.2, 10325.8, 9117.91, 7966.05, 6991.55, 5999.36,
         5076.22, 4354.87, 3665.21, 3040.51, 2519.4, 1964.45, 1617.74, 1261.03, 1003.43, 773.738, 538.73, 427.901,
         328.216, 286.306, 198.838, 151.547, 103.072, 74.4554, 55.072, 46.0, 38.0131, 40.0449, 38.2617, 38.4637, 27.459,
         25.5244],
        [1689.54, 4883.06, 7968.75, 10578.7, 12908.0, 14726.0, 16045.0, 16841.9, 17308.4, 17565.2, 17373.8, 17142.3,
         16334.9, 15641.0, 14858.2, 13906.1, 12844.6, 11582.4, 10607.3, 9597.91, 8498.49, 7448.67, 6481.82, 5603.58,
         4759.9, 4009.17, 3391.99, 2773.91, 2321.67, 1829.77, 1504.03, 1216.72, 968.939, 718.902, 525.594, 428.273,
         313.47, 217.959, 157.799, 116.227, 83.5342, 59.5791, 45.1526, 34.6066, 25.6725, 27.7243, 21.3337, 24.7479,
         24.062, 19.0569],
        [1470.27, 4353.13, 6991.95, 9436.59, 11427.7, 13108.0, 14338.7, 15182.3, 15754.3, 15926.1, 15914.2, 15829.1,
         15243.9, 14516.2, 13763.3, 12904.3, 12004.1, 10809.8, 9868.34, 8866.83, 7844.49, 6915.71, 6018.33, 5204.0,
         4383.46, 3818.16, 3205.02, 2620.66, 2116.11, 1720.96, 1379.41, 1101.49, 837.465, 657.484, 505.077, 373.584,
         272.135, 215.374, 137.021, 104.434, 72.5197, 57.6523, 43.4775, 29.309, 26.7413, 27.9571, 19.6546, 24.4192,
         16.373, 14.0316],
        [1284.77, 3781.4, 6075.68, 8143.16, 10085.9, 11669.1, 12843.2, 13666.2, 14157.2, 14390.6, 14402.2, 14458.5,
         14096.7, 13326.6, 12807.1, 11969.2, 11016.1, 10003.6, 9138.21, 8103.77, 7204.4, 6359.82, 5556.25, 4833.63,
         4149.63, 3426.02, 2874.18, 2379.71, 1943.62, 1557.18, 1221.87, 945.056, 743.636, 592.836, 443.894, 333.492,
         222.997, 198.734, 128.972, 86.9274, 60.011, 52.668, 43.9519, 29.3823, 24.4549, 19.5288, 25.8207, 16.7478,
         17.5353, 9.93459],
        [1134.32, 3312.0, 5384.21, 7219.82, 8801.99, 10250.1, 11365.0, 12246.9, 12799.1, 13096.2, 12997.6, 12969.0,
         12637.8, 12171.8, 11425.2, 10867.2, 10028.2, 9139.46, 8285.64, 7391.61, 6594.24, 5874.02, 5018.85, 4400.71,
         3727.2, 3178.56, 2642.87, 2170.15, 1721.46, 1369.84, 1072.69, 828.307, 664.623, 520.698, 397.436, 295.053,
         198.275, 162.668, 117.903, 75.7898, 42.6963, 43.0625, 29.2068, 22.9446, 15.3518, 10.2275, 13.9127, 11.4044,
         16.1474, 5.06322],
        [964.407, 2897.65, 4718.38, 6350.41, 7811.41, 9023.92, 10105.5, 10815.4, 11461.4, 11654.3, 11642.1, 11527.3,
         11221.1, 10873.5, 10341.7, 9845.86, 9114.34, 8279.37, 7493.8, 6740.95, 5913.75, 5197.56, 4605.01, 3973.14,
         3365.96, 2800.68, 2382.67, 1939.05, 1569.83, 1213.06, 933.127, 742.532, 597.333, 418.105, 336.022, 250.262,
         188.824, 129.212, 95.6255, 69.1149, 43.88, 34.3709, 25.9913, 21.3529, 14.8107, 10.9022, 6.80412, 8.57618,
         5.36867, 7.71352],
        [814.459, 2506.06, 4161.95, 5611.62, 6923.35, 7951.55, 8818.59, 9566.73, 10041.9, 10281.5, 10291.6, 10109.0,
         10004.1, 9611.79, 9231.57, 8674.07, 8106.28, 7268.55, 6701.47, 5971.21, 5348.03, 4653.01, 4007.96, 3500.16,
         2971.07, 2549.66, 2120.26, 1707.8, 1388.75, 1083.57, 868.467, 664.215, 508.159, 392.026, 277.505, 197.981,
         160.528, 107.742, 71.7502, 49.8328, 47.5717, 32.9572, 18.0461, 13.3622, 8.96083, 8.87322, 5.08537, 2.76074,
         4.64589, 4.57283],
        [721.65, 2174.06, 3571.17, 4946.56, 6024.25, 6998.52, 7764.48, 8430.33, 8753.21, 9081.84, 9106.31, 8858.74,
         8834.61, 8419.85, 8204.5, 7756.19, 7194.58, 6527.83, 5786.11, 5168.09, 4644.31, 4109.97, 3467.71, 3052.54,
         2664.16, 2253.31, 1831.69, 1527.39, 1208.99, 927.569, 772.04, 559.416, 445.4, 353.345, 239.074, 187.784,
         126.647, 84.1722, 58.6113, 40.4034, 35.1036, 26.0958, 22.4005, 19.5922, 6.34391, 10.7899, 6.75869, 3.20653,
         6.9215, 6.29338],
        [638.829, 1915.42, 3118.74, 4219.09, 5260.71, 6088.51, 6737.56, 7238.21, 7633.39, 7944.8, 7962.4, 7994.62,
         7707.65, 7485.18, 7109.79, 6822.12, 6332.27, 5661.07, 5156.31, 4586.66, 4123.5, 3607.87, 3067.85, 2653.24,
         2357.97, 1960.24, 1614.07, 1280.26, 1021.85, 828.648, 643.454, 500.934, 382.276, 291.727, 187.394, 145.751,
         96.2649, 71.4163, 52.0742, 33.1279, 25.9162, 14.4491, 10.1259, 6.93269, 5.14673, 6.72863, 6.71209, 2.62352,
         4.24669, 6.94071],
        [536.326, 1665.74, 2647.25, 3623.72, 4469.56, 5248.24, 5833.84, 6287.12, 6694.66, 6946.92, 6930.06, 6948.64,
         6725.36, 6413.74, 6152.04, 5865.36, 5446.69, 4938.21, 4528.84, 4083.42, 3579.57, 3162.73, 2672.29, 2295.74,
         1977.52, 1678.16, 1320.09, 1130.62, 913.123, 689.271, 552.395, 418.616, 311.82, 222.914, 179.628, 136.804,
         83.8969, 64.3588, 40.5793, 33.6433, 25.7289, 13.615, 11.6716, 4.79639, 6.94292, 7.65602, 3.42108, 1.3162,
         2.75936, 2.52274],
        [474.739, 1383.38, 2238.7, 3053.52, 3814.61, 4404.67, 4870.63, 5404.24, 5711.13, 5907.74, 5955.98, 5874.47,
         5783.1, 5668.18, 5311.81, 4990.66, 4691.33, 4255.02, 3917.96, 3471.49, 3115.71, 2668.16, 2269.81, 1966.94,
         1688.61, 1316.92, 1115.38, 962.846, 748.9, 621.206, 470.302, 341.658, 258.608, 172.232, 144.712, 107.508,
         70.046, 47.4487, 42.3901, 28.5844, 18.3547, 10.8081, 6.47577, 6.60907, 4.93364, 1.5362, 1.58851, 2.60774,
         1.42044, 1.10924],
        [395.649, 1170.94, 1923.1, 2601.98, 3227.43, 3815.18, 4239.23, 4609.47, 4973.12, 4986.39, 5052.2, 5064.39,
         5066.12, 4902.15, 4649.27, 4243.55, 3944.48, 3642.64, 3290.38, 2966.65, 2625.97, 2265.75, 1905.94, 1590.41,
         1415.91, 1138.82, 945.231, 764.971, 586.708, 473.556, 344.734, 258.973, 195.767, 157.461, 115.871, 104.486,
         57.0635, 36.3234, 21.3214, 25.0485, 16.7115, 9.96628, 9.92511, 5.03559, 2.24078, 1.76047, 1.62427, 1.17672,
         0.266794, 0.251302],
        [331.365, 985.068, 1621.79, 2182.41, 2758.32, 3166.91, 3534.19, 3962.8, 4139.06, 4222.73, 4362.76, 4319.31,
         4156.31, 3992.34, 3812.59, 3602.64, 3372.76, 3059.61, 2814.76, 2528.58, 2177.58, 1935.1, 1614.85, 1364.12,
         1196.37, 982.311, 807.461, 639.904, 489.431, 379.023, 304.29, 222.373, 150.235, 102.094, 81.5176, 56.0438,
         38.9382, 28.7589, 29.0877, 13.8069, 7.31829, 7.90401, 4.65261, 3.20169, 2.12488, 0.878388, 0.607502, 0.401137,
         0.341232, 0.0],
        [275.394, 826.099, 1353.56, 1818.24, 2321.98, 2697.32, 2994.62, 3243.14, 3481.54, 3600.4, 3617.63, 3558.79,
         3432.28, 3386.0, 3243.53, 3006.48, 2804.47, 2518.8, 2294.32, 1978.1, 1814.03, 1605.48, 1350.33, 1096.29,
         980.122, 844.423, 599.005, 506.357, 387.276, 293.48, 253.585, 183.516, 123.088, 92.9945, 65.3997, 39.4312,
         30.3036, 17.0014, 14.2724, 15.0052, 3.73828, 4.99889, 3.38776, 2.9005, 0.509346, 0.531543, 1.94877, 0.0,
         0.0281004, 0.0],
        [214.326, 660.044, 1158.94, 1564.21, 1894.22, 2249.9, 2511.65, 2654.53, 2786.57, 3051.5, 3007.87, 2903.89,
         2916.87, 2827.2, 2631.05, 2419.85, 2270.4, 2058.4, 1847.26, 1651.24, 1460.45, 1301.15, 1075.86, 944.981,
         780.916, 642.859, 490.762, 399.391, 315.847, 237.669, 178.772, 128.3, 99.7553, 81.0208, 56.9953, 40.0308,
         23.5439, 16.1401, 11.6896, 5.33897, 3.99875, 1.89011, 1.88227, 0.0, 0.0, 0.0, 2.15412, 0.331287, 0.0, 0.0],
        [191.784, 599.246, 987.151, 1340.03, 1579.45, 1813.6, 1994.67, 2232.21, 2331.27, 2400.36, 2398.7, 2353.72,
         2370.58, 2306.82, 2116.94, 2038.47, 1822.44, 1653.33, 1511.62, 1388.94, 1154.7, 1036.43, 876.841, 749.268,
         576.237, 486.549, 401.551, 319.04, 240.987, 195.936, 128.029, 94.6867, 72.176, 65.881, 37.4663, 30.9424,
         21.9181, 12.1259, 9.71016, 6.1839, 0.7202, 1.51808, 0.12274, 0.346032, 1.28929, 0.0, 0.0, 0.0, 0.0, 0.239087],
        [163.141, 473.615, 778.648, 1086.81, 1289.46, 1460.73, 1598.37, 1753.83, 1908.43, 1939.02, 1938.51, 1904.61,
         1881.94, 1805.24, 1769.14, 1644.99, 1489.6, 1393.92, 1260.81, 1080.24, 972.042, 858.426, 697.679, 628.086,
         516.359, 400.823, 333.68, 271.395, 215.873, 151.628, 106.901, 73.7986, 49.7435, 41.812, 27.6392, 12.8399,
         9.47297, 5.4509, 5.58877, 2.64279, 0.0, 1.65981, 0.0, 0.0, 0.363874, 0.493231, 0.0, 0.0, 0.0, 0.462828],
        [127.672, 363.166, 606.659, 871.431, 1057.72, 1176.62, 1340.46, 1463.35, 1493.85, 1619.92, 1583.3, 1576.42,
         1541.25, 1462.84, 1371.11, 1360.61, 1249.21, 1134.82, 993.476, 907.271, 769.375, 683.857, 568.377, 480.733,
         378.213, 309.451, 238.693, 195.416, 136.832, 107.449, 76.0452, 52.8083, 39.4119, 36.9775, 25.9159, 8.70745,
         5.77977, 8.91785, 2.38623, 4.8772, 0.874325, 0.0, 0.0, 0.0, 0.0, 1.54944, 0.035468, 0.0, 0.0, 0.0],
        [104.695, 310.031, 508.037, 663.59, 815.768, 975.77, 1075.91, 1164.93, 1206.39, 1278.96, 1303.46, 1290.44,
         1252.14, 1204.48, 1115.76, 992.59, 1025.19, 898.926, 790.957, 700.917, 586.068, 479.055, 444.086, 369.275,
         296.589, 254.178, 174.718, 136.292, 101.514, 81.9497, 59.7141, 57.1479, 31.1995, 25.8285, 15.5166, 7.63598,
         6.13876, 3.79482, 2.63539, 0.849049, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [71.1511, 243.626, 412.334, 551.297, 679.591, 759.15, 808.446, 881.489, 985.4, 1047.22, 1023.02, 999.575, 940.0,
         936.204, 875.888, 826.212, 754.097, 638.245, 587.276, 519.268, 463.554, 381.575, 330.798, 252.223, 224.901,
         163.784, 123.739, 90.1624, 73.5931, 48.9418, 51.0, 36.5064, 26.1688, 14.4545, 12.5003, 12.8684, 9.569, 4.21859,
         4.74638, 0.0286099, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [56.8257, 186.807, 302.954, 455.757, 517.861, 576.659, 652.205, 693.354, 765.429, 831.49, 810.784, 754.943,
         727.143, 681.936, 690.333, 637.495, 546.963, 499.555, 456.597, 413.158, 360.312, 315.229, 250.369, 210.484,
         161.508, 117.504, 95.4273, 68.0311, 54.9372, 37.244, 42.5883, 25.469, 11.4137, 9.81553, 9.97188, 5.91118,
         3.21632, 5.99009, 2.02894, 1.18422, 0.0721118, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [38.5869, 138.734, 253.41, 320.341, 385.71, 444.606, 507.911, 553.135, 601.463, 640.245, 622.398, 578.605,
         552.866, 529.97, 502.415, 472.385, 398.51, 388.596, 361.559, 298.729, 281.421, 219.737, 201.341, 171.562,
         119.275, 91.4341, 62.149, 49.4253, 26.7745, 28.744, 24.2603, 16.8565, 7.38815, 6.20096, 1.4782, 1.97865,
         2.5721, 1.801, 0.965907, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [36.6111, 110.29, 187.626, 254.134, 287.341, 314.566, 380.838, 411.605, 408.455, 451.743, 425.883, 466.707,
         421.019, 387.926, 352.528, 337.641, 297.384, 273.049, 255.442, 237.254, 183.711, 168.861, 140.003, 118.148,
         76.0151, 63.7265, 53.6355, 33.6241, 26.1275, 19.5104, 16.6501, 17.0797, 5.78949, 4.73418, 2.71162, 0.0,
         1.34806, 1.2385, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [26.9015, 88.4711, 125.488, 201.527, 200.658, 259.708, 262.832, 293.171, 324.49, 346.731, 320.829, 342.772,
         313.809, 279.001, 245.428, 242.572, 221.401, 203.339, 178.655, 152.654, 129.148, 128.913, 96.1842, 72.9295,
         44.1902, 42.3708, 37.8475, 27.6279, 18.8595, 15.9518, 8.10308, 7.2277, 4.45943, 2.94089, 0.390087, 0.570437,
         0.838052, 0.0478007, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [20.1366, 56.9618, 104.579, 142.28, 148.526, 172.067, 186.337, 209.42, 241.432, 240.862, 248.413, 239.732,
         226.548, 211.245, 192.976, 188.573, 171.672, 135.952, 132.104, 111.072, 90.3202, 85.5177, 64.886, 43.8674,
         38.7635, 31.6163, 22.5719, 17.5421, 12.4935, 5.64296, 7.65901, 4.13668, 1.18717, 1.49004, 1.85041, 1.67058,
         0.450896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [15.4117, 34.9525, 57.3936, 105.01, 110.797, 127.124, 149.511, 156.48, 182.863, 176.119, 187.877, 193.228,
         180.698, 168.29, 161.584, 138.849, 118.495, 116.073, 89.5289, 86.0609, 71.6719, 47.4669, 42.4623, 44.8804,
         26.7454, 21.02, 12.8774, 10.0745, 5.16206, 7.08641, 3.37033, 2.85403, 2.21755, 1.04708, 0.899526, 1.02409,
         0.65668, 1.00903, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [7.89156, 30.2902, 45.6082, 57.4264, 77.1927, 96.7886, 110.068, 110.17, 127.325, 128.212, 138.262, 156.447,
         105.778, 115.308, 100.345, 82.0369, 72.0463, 78.3997, 52.1355, 62.0498, 53.3728, 38.5777, 26.5085, 34.1211,
         19.7007, 13.284, 8.90377, 6.5912, 2.5849, 8.02452, 2.06825, 0.733757, 0.8632, 0.589574, 0.0, 0.0, 0.0, 0.0,
         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [6.64107, 18.1039, 34.2886, 55.4346, 46.8088, 66.3414, 80.1797, 70.9737, 86.0697, 87.2195, 101.367, 83.3583,
         72.4741, 58.7153, 66.5905, 56.7732, 57.7023, 59.7181, 41.012, 38.0436, 34.898, 17.7601, 10.7236, 19.2414,
         16.2496, 11.5776, 4.24076, 1.3649, 1.8837, 2.6167, 0.870172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
        [4.67097, 15.7881, 28.8714, 31.2542, 31.6279, 45.2888, 48.1018, 46.923, 57.5012, 64.0966, 84.5963, 51.9534,
         48.557, 53.1423, 46.535, 43.8414, 35.9962, 23.2995, 21.777, 20.3316, 18.061, 13.7486, 11.4096, 11.6989,
         8.48189, 4.09522, 1.65874, 1.40242, 1.16302, 0.689025, 0.295959, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
         0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]

    return energy_cylindrical


@pytest.fixture()
def energy_spherical_data_empty():
    energy_spherical = EnergySpherical()
    return energy_spherical


@pytest.fixture()
def energy_spherical_data():
    energy_spherical = EnergySpherical()
    energy_spherical.maximum_density_keV = 701430.0
    energy_spherical.radius_size_nm = 10.0
    energy_spherical.radius_number_divisions = 50
    energy_spherical.center_nm = [0.0, 0.0, 250.0]

    energy_spherical.radiuses_nm = [0.0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0,
                                    140.0, 150.0, 160.0, 170.0, 180.0, 190.0, 200.0, 210.0, 220.0, 230.0, 240.0, 250.0,
                                    260.0, 270.0, 280.0, 290.0, 300.0, 310.0, 320.0, 330.0, 340.0, 350.0, 360.0, 370.0,
                                    380.0, 390.0, 400.0, 410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0, 480.0, 490.0]
    energy_spherical.energies_keV = [1559.79, 10966.5, 29838.1, 57438.2, 93917.4, 138602.0, 190006.0, 247896.0,
                                     310546.0, 378282.0, 446494.0, 514452.0, 577613.0, 633285.0, 675042.0, 699366.0,
                                     701430.0, 678552.0, 522830.0, 442499.0, 392844.0, 348752.0, 310639.0, 272963.0,
                                     238278.0, 175451.0, 146569.0, 121735.0, 100570.0, 82505.4, 66767.5, 54159.5,
                                     43297.3, 34490.0, 27846.7, 22097.0, 17687.5, 14237.3, 11486.8, 9268.19, 7732.89,
                                     6549.81, 5758.73, 5051.5, 4510.56, 4085.29, 3815.15, 3530.35, 3350.9, 3151.28]

    return energy_spherical


def test_is_discovered():
    """
    Test used to validate the file is included in the tests
    by the test framework.
    """
    # assert False
    assert True


def test_file_path_energy_cartesian_dat(file_path_energy_cartesian_dat):
    assert os.path.isfile(file_path_energy_cartesian_dat)


def test_file_path_energy_cylindrical_dat(file_path_energy_cylindrical_dat):
    assert os.path.isfile(file_path_energy_cylindrical_dat)


def test_file_path_energy_spherical_dat(file_path_energy_spherical_dat):
    assert os.path.isfile(file_path_energy_spherical_dat)


def test_read_cartesian(file_path_energy_cartesian_dat, energy_cartesian_data_empty, energy_cartesian_data):
    energy_cartesian = EnergyCartesian()
    assert energy_cartesian == energy_cartesian_data_empty

    energy_cartesian.read(file_path_energy_cartesian_dat)

    assert energy_cartesian.maximum_density_keV == energy_cartesian_data.maximum_density_keV
    assert energy_cartesian.x_size_nm == energy_cartesian_data.x_size_nm
    assert energy_cartesian.x_number_divisions == energy_cartesian_data.x_number_divisions
    assert energy_cartesian.y_size_nm == energy_cartesian_data.y_size_nm
    assert energy_cartesian.y_number_divisions == energy_cartesian_data.y_number_divisions
    assert energy_cartesian.z_size_nm == energy_cartesian_data.z_size_nm
    assert energy_cartesian.z_number_divisions == energy_cartesian_data.z_number_divisions
    assert energy_cartesian.range_x_nm == energy_cartesian_data.range_x_nm
    assert energy_cartesian.range_y_nm == energy_cartesian_data.range_y_nm
    assert energy_cartesian.range_z_nm == energy_cartesian_data.range_z_nm

    assert energy_cartesian.xs_nm[0] == -250.0
    assert energy_cartesian.xs_nm[1] == -240.0
    assert energy_cartesian.xs_nm[-2] == 230.0
    assert energy_cartesian.xs_nm[-1] == 240.0

    assert energy_cartesian.ys_nm[0] == -250.0
    assert energy_cartesian.ys_nm[1] == -240.0
    assert energy_cartesian.ys_nm[-2] == 230.0
    assert energy_cartesian.ys_nm[-1] == 240.0

    assert energy_cartesian.zs_nm[0] == 0.0
    assert energy_cartesian.zs_nm[1] == 10.0
    assert energy_cartesian.zs_nm[-2] == 480.0
    assert energy_cartesian.zs_nm[-1] == 490.0

    # assert energy_cartesian == energy_cartesian_data
    assert np.all(energy_cartesian.energies_keV == energy_cartesian.energies2_keV)


def test_cartesian_total_energy(file_path_energy_cartesian_dat):
    energy_cartesian = EnergyCartesian()
    energy_cartesian.read(file_path_energy_cartesian_dat)

    assert energy_cartesian.total_energy_keV == 9536354.883729976


def test_read_cylindrical(file_path_energy_cylindrical_dat, energy_cylindrical_data_empty, energy_cylindrical_data):
    energy_cylindrical = EnergyCylindrical()
    assert energy_cylindrical == energy_cylindrical_data_empty

    energy_cylindrical.read(file_path_energy_cylindrical_dat)
    assert energy_cylindrical == energy_cylindrical_data


def test_cylindrical_total_energy(file_path_energy_cylindrical_dat):
    energy_cylindrical = EnergyCylindrical()
    energy_cylindrical.read(file_path_energy_cylindrical_dat)

    assert energy_cylindrical.total_energy_keV == 9899162.6705698


def test_read_spherical(file_path_energy_spherical_dat, energy_spherical_data_empty, energy_spherical_data):
    energy_spherical = EnergySpherical()
    assert energy_spherical == energy_spherical_data_empty

    energy_spherical.read(file_path_energy_spherical_dat)
    assert energy_spherical == energy_spherical_data


def test_spherical_total_energy(file_path_energy_spherical_dat):
    energy_spherical = EnergySpherical()
    energy_spherical.read(file_path_energy_spherical_dat)

    assert energy_spherical.total_energy_keV == 9889795.64
